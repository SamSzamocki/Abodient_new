{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 \{"id":"rg3M4eJbdkCAZPns","name":"Contract_agent","active":false,"isArchived":false,"createdAt":"2025-05-18T15:08:21.906Z","updatedAt":"2025-05-18T15:08:21.906Z","nodes":[\{"parameters":\{"authentication":"oAuth2","resource":"file","operation":"download","fileId":\{"__rl":true,"value":"=\{\{ $json.file_url \}\}","mode":"url"\},"options":\{\}\},"type":"n8n-nodes-base.googleDrive","typeVersion":3,"position":[-720,40],"id":"5cca0956-afd9-4488-bfc9-8d64270af70f","name":"Google Drive"\},\{"parameters":\{"mode":"insert","pineconeIndex":\{"__rl":true,"value":"contract-search","mode":"id"\},"options":\{"pineconeNamespace":"contract-1"\}\},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[-500,40],"id":"3b032515-3537-4a71-8a53-f6b85f6e8d1d","name":"Pinecone Vector Store1","credentials":\{"pineconeApi":\{"id":"smzRdo3KiNPafnXx","name":"PineconeApi account"\}\}\},\{"parameters":\{"notice":"","model":"text-embedding-3-small","options":\{\}\},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[-460,260],"id":"27ef1a68-1904-4ec1-98c7-57d648cdb95b","name":"Embeddings OpenAI1","credentials":\{"openAiApi":\{"id":"ce4Dko4ewvOjQLgW","name":"OpenAi account"\}\}\},\{"parameters":\{"notice":"","dataType":"binary","binaryMode":"allInputData","loader":"auto","options":\{\}\},"type":"@n8n/n8n-nodes-langchain.documentDefaultDataLoader","typeVersion":1,"position":[-320,300],"id":"d6168283-edb9-4c68-b30e-d5833662f6ab","name":"Default Data Loader"\},\{"parameters":\{"notice":"","chunkSize":1000,"chunkOverlap":100,"options":\{\}\},"type":"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter","typeVersion":1,"position":[-340,440],"id":"18ee4e51-9aab-4958-95ac-e6534502e2df","name":"Recursive Character Text Splitter"\},\{"parameters":\{"mode":"manual","duplicateItem":false,"assignments":\{"assignments":[\{"id":"d56e531f-1552-46d3-95ef-20da7399f131","name":"file_url","value":"https://drive.google.com/file/d/1eU4Cw89XRe9vsz_S8EzsUZcquBV_QEOc/view?usp=drive_link","type":"string"\}]\},"includeOtherFields":false,"options":\{\}\},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-980,40],"id":"9e49a629-dace-4f9c-b0e3-c9970e615449","name":"Edit Fields"\},\{"parameters":\{"notice":""\},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1180,40],"id":"6a55eae7-437f-46f3-85bd-773126c32c0a","name":"When clicking \'91Test workflow\'92"\},\{"parameters":\{"events":"worklfow_call","notice":"","outdatedVersionWarning":""\},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1,"position":[0,0],"id":"41ddb6c1-0cc3-4550-8c8a-81a8f232bad5","name":"Execute Workflow Trigger","notesInFlow":false\},\{"parameters":\{"mode":"manual","duplicateItem":false,"assignments":\{"assignments":[\{"id":"dfd52e57-d37d-46ea-a155-2f081b7e189e","name":"contract_query","value":"=\{\{ $json.query \}\}","type":"string"\},\{"id":"670f28c5-64cd-4e1b-a300-c32df0e6a714","name":"chat_query","value":"=\{\{ $json.chatInput \}\}","type":"string"\},\{"id":"398b0a63-b28e-4542-8ae3-b218f76b1a77","name":"","value":"","type":"string"\}]\},"includeOtherFields":false,"options":\{\}\},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[220,0],"id":"a5f178f1-4707-48b1-93c8-d12a992a03c5","name":"Edit Fields1"\},\{"parameters":\{"public":false,"options":\{\}\},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[40,180],"id":"202ac653-3f04-44cc-a20f-0980e3f92f8e","name":"When chat message received","webhookId":"86585911-c4a3-4509-8d43-3b59a8886e06"\},\{"parameters":\{"notice_tip":"","agent":"toolsAgent","promptType":"define","text":"=\{\{ $json.contract_query \}\}\{\{ $json.chat_query \}\}","hasOutputParser":false,"options":\{"systemMessage":"=You are an expert in analysing tenancy contracts to help answer user queries. \\n\\nAvailable tool\\n-contractInformation\\n\\nInstructions\\nUse contractInformation tool to find relevant contractual information related to the query. \\n\\nTasks\\n1) understand the intent of the query and 2) subsequently turn this into an efficient vector search query which you must pass to contractInformation tool\\n\\nOutput\\nYour response to a query must include the full contractual position, clear stating the relevant section of the contract, and provide as much relevant information as you can to help answer the query.\\n\\nYour tone must be helpful, clear and friendly\\n"\},"credentials":""\},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.7,"position":[620,20],"id":"d23179fe-fddf-4d58-8bd0-5dcc6712cd42","name":"AI Agent"\},\{"parameters":\{"notice":"","name":"contractInformation","description":"Returns relevant contractual information related to the query","topK":10\},"type":"@n8n/n8n-nodes-langchain.toolVectorStore","typeVersion":1,"position":[820,280],"id":"89f1b347-0aa9-4fff-b361-857bff94dc41","name":"Vector Store Tool"\},\{"parameters":\{"mode":"retrieve","notice":"","pineconeIndex":\{"__rl":true,"value":"contract-search","mode":"list","cachedResultName":"contract-search"\},"options":\{"pineconeNamespace":"contract-1"\}\},"type":"@n8n/n8n-nodes-langchain.vectorStorePinecone","typeVersion":1,"position":[780,440],"id":"ebcd0004-1c22-4b3a-a99f-5330df8d9cee","name":"Pinecone Vector Store2","credentials":\{"pineconeApi":\{"id":"smzRdo3KiNPafnXx","name":"PineconeApi account"\}\}\},\{"parameters":\{"notice":"","model":"text-embedding-3-small","options":\{\}\},"type":"@n8n/n8n-nodes-langchain.embeddingsOpenAi","typeVersion":1.2,"position":[860,600],"id":"1b4a2e7f-8f8d-4f72-adc7-fc0010e40433","name":"Embeddings OpenAI2","credentials":\{"openAiApi":\{"id":"ce4Dko4ewvOjQLgW","name":"OpenAi account"\}\}\},\{"parameters":\{"notice":"","model":"gpt-4o","options":\{"responseFormat":"text"\}\},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.1,"position":[1080,400],"id":"0893efe9-1fa1-4df0-9161-37914c9ccdbb","name":"OpenAI Chat Model","credentials":\{"openAiApi":\{"id":"ce4Dko4ewvOjQLgW","name":"OpenAi account"\}\}\},\{"parameters":\{"notice":"","model":"gpt-4o-mini","options":\{\}\},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.1,"position":[500,240],"id":"c1d652ac-d64f-42af-a981-3e7deba705b6","name":"OpenAI Chat Model2","credentials":\{"openAiApi":\{"id":"ce4Dko4ewvOjQLgW","name":"OpenAi account"\}\}\},\{"parameters":\{"notice":"","sessionIdType":"customKey","sessionKey":"Take from previous node automatically","contextWindowLength":5\},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[660,240],"id":"a94cb865-a5ba-46d8-9a74-61fe37f282d9","name":"Window Buffer Memory"\}],"connections":\{"Google Drive":\{"main":[[\{"node":"Pinecone Vector Store1","type":"main","index":0\}]]\},"Embeddings OpenAI1":\{"ai_embedding":[[\{"node":"Pinecone Vector Store1","type":"ai_embedding","index":0\}]]\},"Default Data Loader":\{"ai_document":[[\{"node":"Pinecone Vector Store1","type":"ai_document","index":0\}]]\},"Recursive Character Text Splitter":\{"ai_textSplitter":[[\{"node":"Default Data Loader","type":"ai_textSplitter","index":0\}]]\},"Edit Fields":\{"main":[[\{"node":"Google Drive","type":"main","index":0\}]]\},"When clicking \'91Test workflow\'92":\{"main":[[\{"node":"Edit Fields","type":"main","index":0\}]]\},"Execute Workflow Trigger":\{"main":[[\{"node":"Edit Fields1","type":"main","index":0\}]]\},"Edit Fields1":\{"main":[[\{"node":"AI Agent","type":"main","index":0\}]]\},"When chat message received":\{"main":[[\{"node":"Edit Fields1","type":"main","index":0\}]]\},"Pinecone Vector Store2":\{"ai_vectorStore":[[\{"node":"Vector Store Tool","type":"ai_vectorStore","index":0\}]]\},"Embeddings OpenAI2":\{"ai_embedding":[[\{"node":"Pinecone Vector Store2","type":"ai_embedding","index":0\}]]\},"OpenAI Chat Model":\{"ai_languageModel":[[\{"node":"Vector Store Tool","type":"ai_languageModel","index":0\}]]\},"Vector Store Tool":\{"ai_tool":[[\{"node":"AI Agent","type":"ai_tool","index":0\}]]\},"OpenAI Chat Model2":\{"ai_languageModel":[[\{"node":"AI Agent","type":"ai_languageModel","index":0\}]]\},"Window Buffer Memory":\{"ai_memory":[[\{"node":"AI Agent","type":"ai_memory","index":0\}]]\}\},"settings":\{"executionOrder":"v1"\},"staticData":null,"pinData":\{\}\}}